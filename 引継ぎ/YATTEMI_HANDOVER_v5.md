# YatteMi! å®Œå…¨å¼•ãç¶™ãè³‡æ–™

**æœ€çµ‚æ›´æ–°**: 2026å¹´1æœˆ25æ—¥  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: Phase 6 å®Œäº†

---

## ğŸ“‹ ç›®æ¬¡

1. [ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦](#1-ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦)
2. [æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯](#2-æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯)
3. [ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ](#3-ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ )
4. [ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ](#4-ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ)
5. [ä¸»è¦æ©Ÿèƒ½ã¨å®Ÿè£…](#5-ä¸»è¦æ©Ÿèƒ½ã¨å®Ÿè£…)
6. [Supabaseãƒˆãƒªã‚¬ãƒ¼ä¸€è¦§](#6-supabaseãƒˆãƒªã‚¬ãƒ¼ä¸€è¦§)
7. [èªè¨¼ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£](#7-èªè¨¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£)
8. [æ—¢çŸ¥ã®å•é¡Œã¨å¯¾ç­–](#8-æ—¢çŸ¥ã®å•é¡Œã¨å¯¾ç­–)
9. [é–‹ç™ºãƒ•ãƒ­ãƒ¼](#9-é–‹ç™ºãƒ•ãƒ­ãƒ¼)
10. [æ®‹ã‚¿ã‚¹ã‚¯ã¨ç™ºå±•æ¡ˆ](#10-æ®‹ã‚¿ã‚¹ã‚¯ã¨ç™ºå±•æ¡ˆ)
11. [æ¬¡å›ãƒãƒ£ãƒƒãƒˆç”¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ](#11-æ¬¡å›ãƒãƒ£ãƒƒãƒˆç”¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ)

---

## 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

### 1.1 ã‚µãƒ¼ãƒ“ã‚¹ã‚³ãƒ³ã‚»ãƒ—ãƒˆ

**YatteMi!** ã¯å¤§å­¦ç”Ÿå‘ã‘ã‚¹ã‚­ãƒ«ã‚·ã‚§ã‚¢ãƒªãƒ³ã‚°ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã€‚

ã€Œæ•™ãˆãŸã„äººï¼ˆã‚µãƒãƒ¼ã‚¿ãƒ¼ï¼‰ã€ã¨ã€Œå­¦ã³ãŸã„äººï¼ˆãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ£ãƒ¼ï¼‰ã€ã‚’ãƒãƒƒãƒãƒ³ã‚°ã—ã€ã‚¹ã‚­ãƒ«ã®ç›¸äº’å­¦ç¿’ã‚’ä¿ƒé€²ã™ã‚‹ã€‚

### 1.2 æŠ•ç¨¿ã‚¿ã‚¤ãƒ—

| ã‚¿ã‚¤ãƒ— | èª¬æ˜ | ä¾‹ |
|--------|------|-----|
| **support**ï¼ˆã‚µãƒãƒ¼ãƒˆã—ãŸã„ï¼‰ | ã‚¹ã‚­ãƒ«ã‚’æ•™ãˆãŸã„äººãŒæŠ•ç¨¿ | ã€Œãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°æ•™ãˆã¾ã™ã€ |
| **challenge**ï¼ˆãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ãŸã„ï¼‰ | ã‚¹ã‚­ãƒ«ã‚’å­¦ã³ãŸã„äººãŒæŠ•ç¨¿ | ã€Œæ–™ç†ã‚’æ•™ãˆã¦ã»ã—ã„ã€ |

### 1.3 åŸºæœ¬æƒ…å ±

| é …ç›® | å€¤ |
|------|-----|
| æœ¬ç•ªURL | https://yattemi.vercel.app |
| GitHub | ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒª |
| ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‘ã‚¹ | `C:\Users\PC_User\Documents\GitHub\yattemi` |
| é€£çµ¡å…ˆ | yattemi.official@gmail.com |

---

## 2. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### 2.1 ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰

| æŠ€è¡“ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€” |
|------|-----------|------|
| Next.js | 14 (App Router) | ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ |
| TypeScript | 5.x | å‹å®‰å…¨ |
| Tailwind CSS | 3.x | ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚° |
| shadcn/ui | - | UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ |
| Lucide React | - | ã‚¢ã‚¤ã‚³ãƒ³ |
| browser-image-compression | - | ç”»åƒåœ§ç¸® |
| sonner | - | ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ |

### 2.2 ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰

| æŠ€è¡“ | ç”¨é€” |
|------|------|
| Supabase | PostgreSQL DB + èªè¨¼ + ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ |
| Supabase RLS | è¡Œãƒ¬ãƒ™ãƒ«ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ |
| Database Functions | SECURITY DEFINERä»˜ãé–¢æ•° |
| Database Triggers | è‡ªå‹•å‡¦ç†ï¼ˆé€šçŸ¥ç­‰ï¼‰ |

### 2.3 ã‚¤ãƒ³ãƒ•ãƒ©

| æŠ€è¡“ | ç”¨é€” |
|------|------|
| Vercel | ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒ»CI/CD |
| Supabase Storage | ç”»åƒä¿å­˜ |

---

## 3. ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
src/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ (auth)/               # èªè¨¼é–¢é€£ãƒšãƒ¼ã‚¸
â”‚   â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â”œâ”€â”€ signup/
â”‚   â”‚   â””â”€â”€ callback/
â”‚   â”œâ”€â”€ (main)/               # ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
â”‚   â”‚   â”œâ”€â”€ about/            # ã‚µãƒ¼ãƒ“ã‚¹ç´¹ä»‹
â”‚   â”‚   â”œâ”€â”€ applications/     # å¿œå‹Ÿç®¡ç†
â”‚   â”‚   â”œâ”€â”€ challenges/       # ï¼ˆæ—§ãƒ«ãƒ¼ãƒˆã€æœªä½¿ç”¨ï¼Ÿï¼‰
â”‚   â”‚   â”œâ”€â”€ contact/          # ãŠå•ã„åˆã‚ã›
â”‚   â”‚   â”œâ”€â”€ dashboard/        # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
â”‚   â”‚   â”œâ”€â”€ explore/          # æŠ•ç¨¿ä¸€è¦§ï¼ˆãƒ¡ã‚¤ãƒ³ï¼‰
â”‚   â”‚   â”œâ”€â”€ matches/          # ãƒãƒƒãƒãƒ³ã‚°ãƒ»ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
â”‚   â”‚   â”‚   â””â”€â”€ [id]/         # å€‹åˆ¥ãƒãƒ£ãƒƒãƒˆ
â”‚   â”‚   â”œâ”€â”€ notifications/    # é€šçŸ¥ä¸€è¦§
â”‚   â”‚   â”œâ”€â”€ onboarding/       # åˆå›è¨­å®š
â”‚   â”‚   â”œâ”€â”€ posts/            # æŠ•ç¨¿é–¢é€£
â”‚   â”‚   â”‚   â”œâ”€â”€ new/          # æ–°è¦æŠ•ç¨¿
â”‚   â”‚   â”‚   â””â”€â”€ [id]/         # æŠ•ç¨¿è©³ç´°ãƒ»ç·¨é›†
â”‚   â”‚   â”œâ”€â”€ privacy/          # ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼
â”‚   â”‚   â”œâ”€â”€ profile/          # è‡ªåˆ†ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†
â”‚   â”‚   â”œâ”€â”€ settings/         # è¨­å®š
â”‚   â”‚   â”‚   â””â”€â”€ notifications/ # é€šçŸ¥è¨­å®š
â”‚   â”‚   â”œâ”€â”€ support/          # ï¼ˆæ—§ãƒ«ãƒ¼ãƒˆã€æœªä½¿ç”¨ï¼Ÿï¼‰
â”‚   â”‚   â”œâ”€â”€ terms/            # åˆ©ç”¨è¦ç´„
â”‚   â”‚   â””â”€â”€ users/            # ä»–ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«
â”‚   â”‚       â””â”€â”€ [username]/
â”‚   â””â”€â”€ layout.tsx
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ applications/         # å¿œå‹Ÿé–¢é€£
â”‚   â”‚   â”œâ”€â”€ application-card.tsx
â”‚   â”‚   â”œâ”€â”€ application-dialog.tsx
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ common/               # å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ layout/               # ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼ç­‰ï¼‰
â”‚   â”œâ”€â”€ posts/                # æŠ•ç¨¿é–¢é€£
â”‚   â”‚   â”œâ”€â”€ post-card.tsx     # æŠ•ç¨¿ã‚«ãƒ¼ãƒ‰
â”‚   â”‚   â”œâ”€â”€ post-form.tsx     # æŠ•ç¨¿ãƒ•ã‚©ãƒ¼ãƒ 
â”‚   â”‚   â””â”€â”€ post-questions.tsx # å…¬é–‹è³ªå•
â”‚   â”œâ”€â”€ profile/              # ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«é–¢é€£
â”‚   â”‚   â””â”€â”€ profile-image-gallery.tsx
â”‚   â”œâ”€â”€ reviews/              # ãƒ¬ãƒ“ãƒ¥ãƒ¼é–¢é€£
â”‚   â”œâ”€â”€ session/              # ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ»ãƒãƒ£ãƒƒãƒˆ
â”‚   â”‚   â””â”€â”€ session-chat.tsx  # ãƒãƒ£ãƒƒãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ ui/                   # shadcn/ui ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â””â”€â”€ users/                # ãƒ¦ãƒ¼ã‚¶ãƒ¼é–¢é€£
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ use-applications.ts   # å¿œå‹ŸCRUD
â”‚   â”œâ”€â”€ use-auth.ts           # èªè¨¼ï¼ˆç›´æ¥fetchä½¿ç”¨ï¼‰
â”‚   â”œâ”€â”€ use-avatar.ts         # ã‚¢ãƒã‚¿ãƒ¼
â”‚   â”œâ”€â”€ use-challenges.ts     # ãƒãƒ£ãƒ¬ãƒ³ã‚¸
â”‚   â”œâ”€â”€ use-debounce.ts       # ãƒ‡ãƒã‚¦ãƒ³ã‚¹
â”‚   â”œâ”€â”€ use-follow.ts         # ãƒ•ã‚©ãƒ­ãƒ¼
â”‚   â”œâ”€â”€ use-likes.ts          # ã„ã„ã­
â”‚   â”œâ”€â”€ use-messages.ts       # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
â”‚   â”œâ”€â”€ use-post-questions.ts # å…¬é–‹è³ªå•
â”‚   â”œâ”€â”€ use-posts.ts          # æŠ•ç¨¿å–å¾—
â”‚   â””â”€â”€ use-reviews.ts        # ãƒ¬ãƒ“ãƒ¥ãƒ¼
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ image-compression.ts  # ç”»åƒåœ§ç¸®
â”‚   â”œâ”€â”€ supabase/
â”‚   â”‚   â””â”€â”€ client.ts         # Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”‚   â””â”€â”€ utils.ts              # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”œâ”€â”€ stores/
â”‚   â””â”€â”€ notification-store.ts # é€šçŸ¥çŠ¶æ…‹ç®¡ç†
â””â”€â”€ types/
    â”œâ”€â”€ database.ts           # DBå‹å®šç¾©
    â”œâ”€â”€ post-question.ts      # è³ªå•å‹
    â””â”€â”€ index.ts
```

---

## 4. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

### 4.1 ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§

```
profiles          - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«
posts             - æŠ•ç¨¿ï¼ˆlikes_count, questions_count ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚ã‚Šï¼‰
categories        - ã‚«ãƒ†ã‚´ãƒªï¼ˆ17ç¨®é¡ï¼‰
applications      - å¿œå‹Ÿ
matches           - ãƒãƒƒãƒãƒ³ã‚°
messages          - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
notifications     - é€šçŸ¥
likes             - ã„ã„ã­
follows           - ãƒ•ã‚©ãƒ­ãƒ¼
reviews           - ãƒ¬ãƒ“ãƒ¥ãƒ¼
profile_images    - ã‚®ãƒ£ãƒ©ãƒªãƒ¼ç”»åƒ
contact_inquiries - ãŠå•ã„åˆã‚ã›
post_questions    - å…¬é–‹è³ªå•
```

### 4.2 ä¸»è¦ãƒ†ãƒ¼ãƒ–ãƒ«è©³ç´°

#### profiles
```sql
id              uuid PK (auth.users.id)
username        text UNIQUE
display_name    text
avatar_url      text
bio             text
university      text
department      text
grade           int
twitter_url     text
instagram_url   text
website_url     text
is_verified     boolean
is_public       boolean
created_at      timestamptz
updated_at      timestamptz
```

#### posts
```sql
id              uuid PK
user_id         uuid FK â†’ profiles
title           text
description     text
type            enum ('support', 'challenge')
status          enum ('open', 'closed', 'completed', 'cancelled')
category_id     int FK â†’ categories
location_type   text ('online', 'offline', 'hybrid')
max_participants int
deadline        timestamptz
images          text[] (æœ€å¤§5æš)
likes_count     int (ã‚­ãƒ£ãƒƒã‚·ãƒ¥)
questions_count int (ã‚­ãƒ£ãƒƒã‚·ãƒ¥)
created_at      timestamptz
updated_at      timestamptz
```

#### post_questions
```sql
id              uuid PK
post_id         uuid FK â†’ posts
user_id         uuid FK â†’ profiles (è³ªå•è€…)
question_text   text (æœ€å¤§400æ–‡å­—)
answer_text     text (å›ç­”)
answered_at     timestamptz
created_at      timestamptz
deleted_at      timestamptz (è«–ç†å‰Šé™¤)
```

#### notifications
```sql
id              uuid PK
user_id         uuid FK â†’ profiles
type            enum (ä¸‹è¨˜å‚ç…§)
title           text
message         text
data            jsonb (ãƒªãƒ³ã‚¯ç”¨ãƒ‡ãƒ¼ã‚¿)
is_read         boolean
created_at      timestamptz
```

**NotificationTypeä¸€è¦§:**
- `new_application` - æ–°è¦å¿œå‹Ÿ
- `application_accepted` - å¿œå‹Ÿæ‰¿èª
- `application_rejected` - å¿œå‹Ÿå´ä¸‹
- `new_like` - ã„ã„ã­
- `new_follower` - ãƒ•ã‚©ãƒ­ãƒ¼
- `new_message` - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- `new_question` - è³ªå•
- `question_answered` - è³ªå•å›ç­”
- `new_review` - ãƒ¬ãƒ“ãƒ¥ãƒ¼
- `match_completed` - ãƒãƒƒãƒå®Œäº†
- `system` - ã‚·ã‚¹ãƒ†ãƒ é€šçŸ¥

### 4.3 ã‚«ãƒ†ã‚´ãƒªä¸€è¦§ï¼ˆ17ç¨®é¡ï¼‰

| ID | åå‰ |
|----|------|
| 1 | ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚° |
| 2 | ãƒ‡ã‚¶ã‚¤ãƒ³ |
| 3 | èªå­¦ |
| 4 | éŸ³æ¥½ |
| 5 | æ–™ç† |
| 6 | ã‚¹ãƒãƒ¼ãƒ„ |
| 7 | å†™çœŸãƒ»æ˜ åƒ |
| 8 | ãƒ“ã‚¸ãƒã‚¹ |
| 9 | å­¦å• |
| 10 | ãƒãƒ³ãƒ‰ãƒ¡ã‚¤ãƒ‰ |
| 11 | ç¾å®¹ãƒ»ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ |
| 12 | ã‚²ãƒ¼ãƒ  |
| 13 | æ—…è¡Œ |
| 14 | ãƒ©ã‚¤ãƒ•ã‚¹ã‚¿ã‚¤ãƒ« |
| 15 | ãã®ä»– |
| 16 | AIãƒ»æ©Ÿæ¢°å­¦ç¿’ |
| 17 | è³‡æ ¼ãƒ»ã‚­ãƒ£ãƒªã‚¢ |

---

## 5. ä¸»è¦æ©Ÿèƒ½ã¨å®Ÿè£…

### 5.1 èªè¨¼ãƒ•ãƒ­ãƒ¼

```
1. ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ— â†’ Supabase Auth â†’ ãƒ¡ãƒ¼ãƒ«èªè¨¼
2. ãƒ­ã‚°ã‚¤ãƒ³ â†’ ã‚»ãƒƒã‚·ãƒ§ãƒ³å–å¾— â†’ ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç¢ºèª
3. åˆå›ãƒ­ã‚°ã‚¤ãƒ³ â†’ /onboarding ã§ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®š
4. ä»¥é™ â†’ /explore ãŒãƒ›ãƒ¼ãƒ 
```

**é‡è¦**: `use-auth.ts` ã¯Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ãƒ•ãƒªãƒ¼ã‚ºå•é¡ŒãŒã‚ã‚‹ãŸã‚ã€ç›´æ¥fetchã‚’ä½¿ç”¨ã€‚

### 5.2 æŠ•ç¨¿ãƒ•ãƒ­ãƒ¼

```
1. /posts/new ã§æŠ•ç¨¿ä½œæˆ
2. ç”»åƒã¯ browser-image-compression ã§åœ§ç¸®ï¼ˆæœ€å¤§1MBã€1920pxï¼‰
3. Supabase Storage ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
4. posts ãƒ†ãƒ¼ãƒ–ãƒ«ã« INSERT
```

### 5.3 å¿œå‹Ÿã€œãƒãƒƒãƒãƒ³ã‚°ãƒ•ãƒ­ãƒ¼

```
1. æŠ•ç¨¿è©³ç´°ã‹ã‚‰ã€Œå¿œå‹Ÿã™ã‚‹ã€
2. applications ãƒ†ãƒ¼ãƒ–ãƒ«ã« INSERT
3. æŠ•ç¨¿è€…ã«é€šçŸ¥ï¼ˆnotify_on_application ãƒˆãƒªã‚¬ãƒ¼ï¼‰
4. æŠ•ç¨¿è€…ãŒæ‰¿èª â†’ matches ãƒ†ãƒ¼ãƒ–ãƒ«ã« INSERT
5. å¿œå‹Ÿè€…ã«é€šçŸ¥ï¼ˆnotify_on_application_status_change ãƒˆãƒªã‚¬ãƒ¼ï¼‰
6. /matches/[id] ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å¯èƒ½ã«
```

### 5.4 å…¬é–‹è³ªå•æ©Ÿèƒ½

```
1. æŠ•ç¨¿è©³ç´°ãƒšãƒ¼ã‚¸ã§è³ªå•æŠ•ç¨¿ï¼ˆèªè¨¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ï¼‰
2. æŠ•ç¨¿è€…ã«é€šçŸ¥ï¼ˆnotify_on_question ãƒˆãƒªã‚¬ãƒ¼ï¼‰
3. æŠ•ç¨¿è€…ãŒå›ç­”
4. è³ªå•è€…ã«é€šçŸ¥ï¼ˆnotify_on_question_answer ãƒˆãƒªã‚¬ãƒ¼ï¼‰
```

**å‰Šé™¤ãƒ«ãƒ¼ãƒ«:**
- è³ªå•è€…: æŠ•ç¨¿å¾Œ10åˆ†ä»¥å†…ã®ã¿
- æŠ•ç¨¿è€…: ã„ã¤ã§ã‚‚å¯èƒ½
- å®Ÿè£…: `delete_post_question` Database Function

### 5.5 é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ 

**é€šçŸ¥ä½œæˆï¼ˆSupabaseãƒˆãƒªã‚¬ãƒ¼ï¼‰:**

| ãƒˆãƒªã‚¬ãƒ¼å | ã‚¤ãƒ™ãƒ³ãƒˆ | é€šçŸ¥ã‚¿ã‚¤ãƒ— |
|-----------|---------|-----------|
| notify_on_application | å¿œå‹ŸINSERT | new_application |
| notify_on_application_status_change | å¿œå‹ŸUPDATE | application_accepted/rejected |
| notify_on_like | ã„ã„ã­INSERT | new_like |
| notify_on_follow | ãƒ•ã‚©ãƒ­ãƒ¼INSERT | new_follower |
| notify_on_message | ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸INSERT | new_message |
| notify_on_question | è³ªå•INSERT | new_question |
| notify_on_question_answer | è³ªå•UPDATE(å›ç­”) | question_answered |
| notify_on_review | ãƒ¬ãƒ“ãƒ¥ãƒ¼INSERT | new_review |

**é€šçŸ¥ãƒªãƒ³ã‚¯ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆå´ã§å‹•çš„ç”Ÿæˆï¼‰:**

```typescript
// src/app/(main)/notifications/page.tsx
const getLink = (notification) => {
  const data = notification.data;
  switch (notification.type) {
    case 'new_like':
    case 'new_question':
    case 'question_answered':
      return `/posts/${data.post_id}`;
    case 'new_follower':
      return data.username ? `/users/${data.username}` : null;
    case 'new_application':
      return '/dashboard?tab=received';
    case 'application_accepted':
    case 'application_rejected':
      return '/dashboard?tab=sent';
    case 'new_message':
      return data.match_id ? `/messages/${data.match_id}` : '/messages';
    case 'new_review':
      return '/dashboard?tab=reviews';
  }
};
```

### 5.6 ã„ã„ã­ãƒ»è³ªå•æ•°ã‚­ãƒ£ãƒƒã‚·ãƒ¥

`posts` ãƒ†ãƒ¼ãƒ–ãƒ«ã« `likes_count`, `questions_count` ã‚«ãƒ©ãƒ ã‚’è¿½åŠ ã€‚

**ãƒˆãƒªã‚¬ãƒ¼ã§è‡ªå‹•æ›´æ–°:**
- `update_likes_count` - ã„ã„ã­INSERT/DELETEã§æ›´æ–°
- `update_questions_count` - è³ªå•INSERT/UPDATE/DELETEã§æ›´æ–°

---

## 6. Supabaseãƒˆãƒªã‚¬ãƒ¼ä¸€è¦§

### 6.1 é€šçŸ¥ç³»

| é–¢æ•°å | ãƒˆãƒªã‚¬ãƒ¼å¯¾è±¡ | èª¬æ˜ |
|--------|-------------|------|
| notify_on_application | applications INSERT | å¿œå‹Ÿé€šçŸ¥ |
| notify_on_application_status_change | applications UPDATE | æ‰¿èª/å´ä¸‹é€šçŸ¥ |
| notify_on_like | likes INSERT | ã„ã„ã­é€šçŸ¥ |
| notify_on_follow | follows INSERT | ãƒ•ã‚©ãƒ­ãƒ¼é€šçŸ¥ï¼ˆusernameå«ã‚€ï¼‰ |
| notify_on_message | messages INSERT | ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€šçŸ¥ |
| notify_on_question | post_questions INSERT | è³ªå•é€šçŸ¥ |
| notify_on_question_answer | post_questions UPDATE | å›ç­”é€šçŸ¥ |
| notify_on_review | reviews INSERT | ãƒ¬ãƒ“ãƒ¥ãƒ¼é€šçŸ¥ |

### 6.2 ã‚«ã‚¦ãƒ³ãƒˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ç³»

| é–¢æ•°å | ãƒˆãƒªã‚¬ãƒ¼å¯¾è±¡ | èª¬æ˜ |
|--------|-------------|------|
| update_likes_count | likes INSERT/DELETE | posts.likes_countæ›´æ–° |
| update_questions_count | post_questions INSERT/UPDATE/DELETE | posts.questions_countæ›´æ–° |

---

## 7. èªè¨¼ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

### 7.1 Row Level Security (RLS)

ä¸»è¦ãªãƒãƒªã‚·ãƒ¼:

```sql
-- profiles: èª°ã§ã‚‚é–²è¦§å¯ã€æœ¬äººã®ã¿æ›´æ–°
-- posts: èª°ã§ã‚‚é–²è¦§å¯ã€æœ¬äººã®ã¿æ›´æ–°/å‰Šé™¤
-- applications: é–¢ä¿‚è€…ã®ã¿é–²è¦§/æ›´æ–°
-- messages: ãƒãƒƒãƒå‚åŠ è€…ã®ã¿
-- notifications: æœ¬äººã®ã¿
```

### 7.2 Database Functions (SECURITY DEFINER)

RLSã‚’å›é¿ã—ã¦æ¨©é™ãƒã‚§ãƒƒã‚¯ä»˜ãã§å®Ÿè¡Œ:

```sql
-- è³ªå•å‰Šé™¤
delete_post_question(question_id uuid)

-- ä½¿ç”¨ä¾‹
const { error } = await supabase.rpc('delete_post_question', {
  question_id: id
});
```

---

## 8. æ—¢çŸ¥ã®å•é¡Œã¨å¯¾ç­–

### 8.1 Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ãƒ•ãƒªãƒ¼ã‚º

**ç—‡çŠ¶**: `supabase.from('profiles').select()` ãŒå¿œç­”ã—ãªã„

**å¯¾ç­–**: `use-auth.ts` ã§ç›´æ¥ `fetch()` ã‚’ä½¿ç”¨

```typescript
// âŒ ãƒ•ãƒªãƒ¼ã‚ºã™ã‚‹ã“ã¨ãŒã‚ã‚‹
const { data } = await supabase.from('profiles').select('*').eq('id', userId).single();

// âœ… ç¢ºå®Ÿã«å‹•ã
const response = await fetch(
  `${process.env.NEXT_PUBLIC_SUPABASE_URL}/rest/v1/profiles?id=eq.${userId}&select=*`,
  {
    headers: {
      'apikey': process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
      'Authorization': `Bearer ${token}`,
    },
  }
);
```

### 8.2 RLSã§UPDATE 403ã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**: ãƒãƒªã‚·ãƒ¼ãŒæ­£ã—ãã¦ã‚‚ `PATCH` ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒ403

**å¯¾ç­–**: `SECURITY DEFINER` ä»˜ãã®Database Functionã‚’ä½¿ç”¨

### 8.3 Supabaseå‹ã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**: `from('post_questions')` ã§å‹ã‚¨ãƒ©ãƒ¼

**å¯¾ç­–**: `(supabase as any).from('post_questions')` ã§ã‚­ãƒ£ã‚¹ãƒˆ

### 8.4 PowerShellã®æ–‡å­—åŒ–ã‘

**ç—‡çŠ¶**: ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œã§æ—¥æœ¬èªãŒåŒ–ã‘ã‚‹

**å¯¾ç­–**: 
```powershell
# PowerShell 7ã§å®Ÿè¡Œ
pwsh
# UTF-8 BOMãªã—æŒ‡å®š
Get-Content -Encoding utf8NoBOM
Set-Content -Encoding utf8NoBOM
```

---

## 9. é–‹ç™ºãƒ•ãƒ­ãƒ¼

### 9.1 åŸºæœ¬ã‚³ãƒãƒ³ãƒ‰

```bash
# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run dev

# ãƒ“ãƒ«ãƒ‰ç¢ºèª
npm run build

# ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆVercelè‡ªå‹•ï¼‰
git add -A
git commit -m "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"
git push

# ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
Remove-Item -Recurse -Force .next
npm run dev
```

### 9.2 PowerShellã§ã®ãƒ•ã‚¡ã‚¤ãƒ«ç·¨é›†

```powershell
# ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹å–å¾—
$content = Get-Content "ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹" -Raw -Encoding utf8NoBOM

# ç½®æ›
$content = $content -replace [regex]::Escape($old), $new

# ä¿å­˜
Set-Content "ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹" -Value $content -NoNewline -Encoding utf8NoBOM

# ç‰¹å®šè¡Œã®å–å¾—ï¼ˆ0å§‹ã¾ã‚Šï¼‰
(Get-Content "ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹" -Encoding utf8NoBOM)[10..20]

# æ¤œç´¢
Select-String -Path "src\**\*.tsx" -Pattern "æ¤œç´¢èª" 
Get-ChildItem -Recurse -Include "*.tsx" | Select-String -Pattern "æ¤œç´¢èª"
```

### 9.3 Supabase SQLå®Ÿè¡Œ

Supabaseç®¡ç†ç”»é¢ â†’ SQL Editor ã§å®Ÿè¡Œ

---

## 10. æ®‹ã‚¿ã‚¹ã‚¯ã¨ç™ºå±•æ¡ˆ

### 10.1 å„ªå…ˆåº¦é«˜ï¼ˆãƒã‚°ãƒ»UXæ”¹å–„ï¼‰

| ã‚¿ã‚¹ã‚¯ | è©³ç´° | çŠ¶æ…‹ |
|--------|------|------|
| IntersectionObserverä¿®æ­£ | ç„¡é™ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãŒå‹•ã‹ãªã„ | èª¿æŸ»ä¸­æ–­ |
| ãƒãƒƒãƒãƒ³ã‚°å¾Œã®å°ç·šæ•´ç† | ãƒ•ãƒ­ãƒ¼ãŒã‚ã‹ã‚Šã«ãã„ | æœªç€æ‰‹ |

### 10.2 å„ªå…ˆåº¦ä¸­ï¼ˆæ©Ÿèƒ½è¿½åŠ ï¼‰

| ã‚¿ã‚¹ã‚¯ | è©³ç´° | å®Ÿè£…æ¡ˆ |
|--------|------|--------|
| è³ªå•ã®é€šå ±æ©Ÿèƒ½ | ä¸é©åˆ‡ãªè³ªå•ã‚’å ±å‘Š | question_reportsãƒ†ãƒ¼ãƒ–ãƒ«è¿½åŠ  |
| ãƒ¬ãƒ“ãƒ¥ãƒ¼å‚¬ä¿ƒé€šçŸ¥ | ãƒãƒƒãƒå®Œäº†å¾ŒNæ—¥ã§è‡ªå‹•é€šçŸ¥ | pg_cron or Vercel Cron |
| å¿œå‹Ÿæ”¾ç½®é€šçŸ¥ | é•·æœŸé–“æœªå‡¦ç†ã®å¿œå‹Ÿã‚’é€šçŸ¥ | åŒä¸Š |
| å¤ã„é€šçŸ¥ã®è‡ªå‹•å‰Šé™¤ | 30æ—¥ä»¥ä¸ŠçµŒéã§å‰Šé™¤ | pg_cronã§å®šæœŸå®Ÿè¡Œ |

### 10.3 å„ªå…ˆåº¦ä½ï¼ˆç™ºå±•ï¼‰

| ã‚¿ã‚¹ã‚¯ | è©³ç´° |
|--------|------|
| è³ªå•ã¸ã®ã„ã„ã­æ©Ÿèƒ½ | è‰¯ã„è³ªå•ã‚’è©•ä¾¡ |
| é€šçŸ¥ã®ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥ | Firebase Cloud Messagingé€£æº |
| Supabaseå‹è‡ªå‹•ç”Ÿæˆ | `supabase gen types typescript` |
| ãƒ†ã‚¹ãƒˆè¿½åŠ  | Jest / Playwright |
| ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ | Tailwind dark: |
| PWAå¯¾å¿œ | ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œ |
| æ¤œç´¢æ©Ÿèƒ½å¼·åŒ– | å…¨æ–‡æ¤œç´¢ï¼ˆpg_trgmï¼‰ |

### 10.4 èª¿æŸ»ãŒå¿…è¦

| é …ç›® | è©³ç´° |
|------|------|
| /challenges, /support ãƒ«ãƒ¼ãƒˆ | ä½¿ã‚ã‚Œã¦ã‚‹ï¼Ÿå‰Šé™¤å¯èƒ½ï¼Ÿ |
| use-challenges.ts | ä½•ã«ä½¿ã£ã¦ã‚‹ï¼Ÿ |

---

## 11. æ¬¡å›ãƒãƒ£ãƒƒãƒˆç”¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

```
YatteMi! é–‹ç™ºã®ç¶šã

## æ¦‚è¦
å¤§å­¦ç”Ÿå‘ã‘ã‚¹ã‚­ãƒ«ã‚·ã‚§ã‚¢ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ 
æ•™ãˆãŸã„äººï¼ˆã‚µãƒãƒ¼ãƒˆï¼‰ã¨å­¦ã³ãŸã„äººï¼ˆãƒãƒ£ãƒ¬ãƒ³ã‚¸ï¼‰ã®ãƒãƒƒãƒãƒ³ã‚°

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
Next.js 14 + TypeScript + Tailwind + Supabase + Vercel

## ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‘ã‚¹
C:\Users\PC_User\Documents\GitHub\yattemi

## å‰å›å®Œäº†ï¼ˆPhase 6ï¼‰
- é€šçŸ¥æ©Ÿèƒ½æ‹¡å¼µï¼ˆè³ªå•ãƒ»å›ç­”ãƒ»ãƒ¬ãƒ“ãƒ¥ãƒ¼é€šçŸ¥ãƒˆãƒªã‚¬ãƒ¼è¿½åŠ ï¼‰
- é€šçŸ¥ãƒªãƒ³ã‚¯å‹•çš„ç”Ÿæˆï¼ˆdata JSONã‹ã‚‰ãƒªãƒ³ã‚¯ç”Ÿæˆï¼‰
- é€šçŸ¥UIã‚³ãƒ³ãƒ‘ã‚¯ãƒˆåŒ–
- DMé€ä¿¡ãƒœã‚¿ãƒ³è¦–èªæ€§æ”¹å–„
- å¿œå‹Ÿè€…ã‚«ãƒ¼ãƒ‰ã‹ã‚‰ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒªãƒ³ã‚¯è¿½åŠ 
- likes_count/questions_count ã‚­ãƒ£ãƒƒã‚·ãƒ¥å®Ÿè£…

## æ®‹ã‚¿ã‚¹ã‚¯
1. IntersectionObserverä¿®æ­£ï¼ˆç„¡é™ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼‰
2. ãƒãƒƒãƒãƒ³ã‚°å¾Œã®å°ç·šæ•´ç†
3. è³ªå•ã®é€šå ±æ©Ÿèƒ½
4. ãƒ¬ãƒ“ãƒ¥ãƒ¼å‚¬ä¿ƒé€šçŸ¥
5. /challenges, /support ãƒ«ãƒ¼ãƒˆã®èª¿æŸ»

## ä¸»è¦ãƒ•ã‚¡ã‚¤ãƒ«
- æŠ•ç¨¿ä¸€è¦§: src/app/(main)/explore/page.tsx
- æŠ•ç¨¿è©³ç´°: src/app/(main)/posts/[id]/page.tsx
- é€šçŸ¥ä¸€è¦§: src/app/(main)/notifications/page.tsx
- èªè¨¼ãƒ•ãƒƒã‚¯: src/hooks/use-auth.tsï¼ˆç›´æ¥fetchä½¿ç”¨ï¼‰
- æŠ•ç¨¿ãƒ•ãƒƒã‚¯: src/hooks/use-posts.ts

## Supabaseãƒˆãƒªã‚¬ãƒ¼
é€šçŸ¥ç³»: notify_on_application, notify_on_like, notify_on_follow, 
       notify_on_message, notify_on_question, notify_on_question_answer, notify_on_review
ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç³»: update_likes_count, update_questions_count

## æ—¢çŸ¥ã®å•é¡Œ
- Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒãƒ•ãƒªãƒ¼ã‚ºã™ã‚‹ã“ã¨ãŒã‚ã‚‹ â†’ ç›´æ¥fetchä½¿ç”¨
- RLSã§UPDATE 403ã‚¨ãƒ©ãƒ¼ â†’ Database Functionä½¿ç”¨
- Supabaseå‹ã‚¨ãƒ©ãƒ¼ â†’ (supabase as any) ã§ã‚­ãƒ£ã‚¹ãƒˆ
- PowerShellæ–‡å­—åŒ–ã‘ â†’ pwsh + utf8NoBOMæŒ‡å®š

## æœ¬ç•ªURL
https://yattemi.vercel.app

## å¼•ãç¶™ãè³‡æ–™
/mnt/user-data/uploads/YATTEMI_HANDOVER_v5.md
```

---

## ç’°å¢ƒå¤‰æ•°

`.env.local` ã«å¿…è¦:
```
NEXT_PUBLIC_SUPABASE_URL=https://bojkczhgfhxazuiomktv.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=xxxxx
```

---

## Supabaseãƒˆãƒªã‚¬ãƒ¼ä½œæˆSQLï¼ˆå‚è€ƒï¼‰

### è³ªå•é€šçŸ¥

```sql
CREATE OR REPLACE FUNCTION notify_on_question()
RETURNS TRIGGER AS $$
DECLARE
  post_owner_id uuid;
  questioner_name text;
  post_title text;
BEGIN
  SELECT user_id, title INTO post_owner_id, post_title
  FROM posts WHERE id = NEW.post_id;
  
  IF post_owner_id = NEW.user_id THEN RETURN NEW; END IF;
  
  SELECT display_name INTO questioner_name
  FROM profiles WHERE id = NEW.user_id;
  
  INSERT INTO notifications (user_id, type, title, message, data)
  VALUES (
    post_owner_id, 'new_question', 'æ–°ã—ã„è³ªå•',
    questioner_name || 'ã•ã‚“ãŒã€Œ' || LEFT(post_title, 20) || 'ã€ã«è³ªå•ã—ã¾ã—ãŸ',
    jsonb_build_object('post_id', NEW.post_id, 'question_id', NEW.id, 'user_id', NEW.user_id)
  );
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;
```

### ãƒ•ã‚©ãƒ­ãƒ¼é€šçŸ¥ï¼ˆusernameå«ã‚€ï¼‰

```sql
CREATE OR REPLACE FUNCTION notify_on_follow()
RETURNS TRIGGER AS $$
DECLARE
  follower_name text;
  follower_username text;
BEGIN
  SELECT display_name, username INTO follower_name, follower_username
  FROM profiles WHERE id = NEW.follower_id;
  
  INSERT INTO notifications (user_id, type, title, message, data)
  VALUES (
    NEW.following_id, 'new_follower', 'æ–°ã—ã„ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼',
    follower_name || 'ã•ã‚“ãŒã‚ãªãŸã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¾ã—ãŸ',
    jsonb_build_object('user_id', NEW.follower_id, 'username', follower_username)
  );
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;
```

---

*ã“ã®è³‡æ–™ã¯é–‹ç™ºã®å¼•ãç¶™ãç”¨ã§ã™ã€‚*  
*æœ€çµ‚æ›´æ–°: 2026å¹´1æœˆ25æ—¥*
